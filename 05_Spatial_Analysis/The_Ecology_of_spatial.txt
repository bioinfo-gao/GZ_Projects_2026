# https://chatgpt.com/c/69a0e1bb-a824-832b-9132-a564d32b1920
å½“å‰ç©ºé—´è½¬å½•ç»„ï¼ˆspatial transcriptomicsï¼‰åˆ†æçš„å®é™…ä½¿ç”¨æ¯”ä¾‹ï¼ŒåŸºäºè¿‘å‡ å¹´æ–¹æ³•è®ºæ–‡ã€GitHub ç”Ÿæ€ã€æ•™ç¨‹å’Œä¼šè®®æŠ¥å‘Šçš„è§‚å¯Ÿï¼Œå¤§è‡´å¯ä»¥è¿™æ ·åˆ¤æ–­ï¼š
ç²—ç•¥åŒºé—´ï¼ˆ2023â€“2026 å­¦æœ¯ç”Ÿæ€è§‚å¯Ÿï¼‰
Pythonï¼šâ‰ˆ 70%â€“85%
Rï¼šâ‰ˆ 15%â€“30%
å¾ˆéš¾ç²¾ç¡®åˆ°â€œåˆ°åº•æ˜¯ 73% è¿˜æ˜¯ 82%â€ï¼Œå› ä¸ºæ²¡æœ‰å®˜æ–¹ç»Ÿè®¡ï¼Œä½†ä»å·¥å…·ç”Ÿæ€å’Œè®ºæ–‡ä»£ç ä»“åº“æ¥çœ‹ï¼š
æ–°æ–¹æ³•è®ºæ–‡å¤§å¤šæ•°åŸºäº
Scanpy
Squidpy
scvi-tools
æ·±åº¦å­¦ä¹ /å›¾ç¥ç»ç½‘ç»œæ¨¡å‹å‡ ä¹å…¨éƒ¨åœ¨ Pythonï¼ˆPyTorch ç”Ÿæ€ï¼‰
è€Œ R ä¸»è¦é›†ä¸­åœ¨ï¼š
Seuratï¼ˆéå¸¸å¸¸ç”¨ï¼Œä½†åå•ç»†èƒå»¶ä¼¸ï¼‰
Giotto



åœ¨å¤„ç†ç©ºé—´è½¬å½•ç»„ï¼ˆSpatial Transcriptomicsï¼‰æ—¶ï¼ŒR è¯­è¨€ç”Ÿæ€ï¼ˆä¸»è¦æ˜¯ Seurat v5 å’Œ Giottoï¼‰ä¸ Python ç”Ÿæ€ï¼ˆSquidpy/Scanpyï¼‰æœ‰æ˜¾è‘—åŒºåˆ«ã€‚
å…³äº GPU çš„å›ç­”ï¼šåœ¨ R ç”Ÿæ€é‡Œä½¿ç”¨ GPU å—ï¼Ÿ
ç­”æ¡ˆæ˜¯ï¼šæ”¯æŒï¼Œä½†ä¸å¦‚ Python ä¸æ»‘ã€‚
åŸç”Ÿ R ä¸æ”¯æŒ GPUï¼šR çš„åŸºç¡€çŸ©é˜µè¿ç®—é»˜è®¤åªè·‘åœ¨ CPU ä¸Šã€‚
Seurat v5 çš„ GPU æ”¯æŒï¼šSeurat v5 å¼•å…¥äº† SeuratWrappers å’Œ BPCellsï¼Œå¯ä»¥è°ƒç”¨ CuArrays æˆ– TensorFlow/Torch åç«¯è¿›è¡ŒåŠ é€Ÿï¼Œä½†é…ç½®éå¸¸å¤æ‚ã€‚
æ ¸å¿ƒåŠ é€Ÿè·¯å¾„ï¼šåœ¨ R ç”Ÿæ€é‡Œï¼ŒGPU ä¸»è¦ç”¨äºï¼š
æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼šå¦‚ç©ºé—´åå·ç§¯ï¼ˆSpatial Deconvolutionï¼‰æˆ–æ•´åˆï¼ˆIntegrationï¼‰ã€‚
æ··åˆç”Ÿæ€ï¼šé€šè¿‡ reticulate è°ƒç”¨ Python çš„ GPU ç¯å¢ƒï¼ˆå¦‚ä½¿ç”¨ Python çš„ scvi-tools æˆ– Tangramï¼‰ã€‚
çŸ©é˜µè¿ç®—ä¼˜åŒ–ï¼šé€šè¿‡ OpenBLAS æˆ– MKL ä¼˜åŒ– CPU è®¡ç®—ï¼Œæˆ–è€…ç‰¹å®šçš„ gpuR åŒ…ï¼ˆè¾ƒå°‘ç”¨ï¼‰ã€‚
å…¨ç¨‹æŒ‡å¯¼ï¼šæ„å»º WSL2 ä¸‹çš„ R ç©ºé—´è½¬å½•ç»„åˆ†æç¯å¢ƒ
é’ˆå¯¹æ‚¨çš„ RTX 3060 (WSL2) + 9.7GB å†…å­˜ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªä»¥ Seurat v5 ä¸ºæ ¸å¿ƒï¼Œå¹¶å…¼å®¹ Giotto çš„ç¯å¢ƒã€‚
ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºç‹¬ç«‹çš„ R ç¯å¢ƒ
ä¸è¦æŠŠ R è£…åœ¨ä¹‹å‰çš„ scRNA_gpu è¿è¡Œç¯å¢ƒé‡Œï¼Œå»ºè®®ç‹¬ç«‹å‡ºæ¥ä»¥é˜²ä¾èµ–å†²çªã€‚
code
Bash
# åˆ›å»º R 4.4 ç¯å¢ƒï¼ˆç›®å‰ç”Ÿä¿¡æœ€ç¨³ç‰ˆæœ¬ï¼‰
micromamba create -n spatial_R r-base=4.4 r-essentials r-reticulate r-xml r-curl r-openssl -c conda-forge -y

# æ¿€æ´»ç¯å¢ƒ
micromamba activate spatial_R
ç¬¬äºŒæ­¥ï¼šç³»ç»Ÿåº•å±‚ä¾èµ–å®‰è£… (Linux ç»ˆç«¯æ‰§è¡Œ)
ç©ºé—´åˆ†ææ¶‰åŠå¤§é‡åœ°ç†ç©ºé—´è®¡ç®—ï¼ˆGISï¼‰åº“ï¼Œå¿…é¡»å…ˆè£…å¥½ç³»ç»Ÿæ’ä»¶ï¼š
code
Bash
sudo apt update
sudo apt install -y libgeos-dev libgdal-dev libproj-dev libudunits2-dev libfftw3-dev libgsl-dev
ç¬¬ä¸‰æ­¥ï¼šå®‰è£…æ ¸å¿ƒ R åŒ… (R å†…éƒ¨æ‰§è¡Œ)
è¿›å…¥ R äº¤äº’ç•Œé¢ï¼š
code
Bash
R
åœ¨ R æç¤ºç¬¦ > ä¸‹æ‰§è¡Œï¼š
code
R
# 1. å®‰è£…åŸºç¡€å·¥å…·
install.packages(c("tidyverse", "httpgd", "languageserver", "BiocManager"))

# 2. å®‰è£… Seurat v5 (ç©ºé—´åˆ†ææ——èˆ°åŒ…)
options(repos = c(spatstat = 'https://spatstat.r-universe.dev', CRAN = 'https://cloud.r-project.org'))
install.packages("Seurat")

# 3. å®‰è£… Bioconductor ç©ºé—´ä¸“ç”¨åŒ…
BiocManager::install(c("BayesSpace", "Voyager", "SpatialExperiment", "scuttle"))

# 4. å®‰è£… Giotto (å¦ä¸€ä¸ªå¼ºå¤§çš„ç©ºé—´åˆ†ææ¡†æ¶)
# Giotto ç»å¸¸æ›´æ–°ï¼Œå»ºè®®ä» GitHub å®‰è£…
if (!requireNamespace("remotes", quietly = TRUE)) install.packages("remotes")
remotes::install_github("Giotto-Package/Giotto")
ç¬¬å››æ­¥ï¼šæ‰“é€š GPU åŠ é€Ÿæ¡¥æ¢ (R ä¸ Python è”åŠ¨)
ç”±äº RTX 3060 çš„ç®—åŠ›ä¸»è¦åœ¨ Python ç«¯ï¼Œæˆ‘ä»¬éœ€è¦è®© R æŒ‡å‘ä½ ä¹‹å‰å»ºå¥½çš„ scRNA_gpu ç¯å¢ƒã€‚
åœ¨ R è„šæœ¬ä¸­è¿™æ ·è®¾ç½®ï¼š
code
R
library(reticulate)

# æŒ‡å‘ä½ ä¹‹å‰å»ºç«‹çš„åŒ…å« GPU ç‰ˆ Torch çš„ç¯å¢ƒ
use_miniconda("~/micromamba/envs/scRNA_gpu")

# æ£€æŸ¥æ˜¯å¦æˆåŠŸé“¾æ¥åˆ° GPU ç‰ˆ Python
py_config()
ç¬¬äº”æ­¥ï¼šVS Code é…ç½®ï¼ˆå®ç°ä¸æ»‘å¼€å‘ï¼‰
ä¸ºäº†åœ¨ VS Code é‡Œåƒç”¨ Python ä¸€æ ·èˆ’æœåœ°ç”¨ Rï¼š
å®‰è£…æ‰©å±•ï¼šåœ¨ VS Code æ’ä»¶å¸‚åœºå®‰è£… "R" (Yuki Ueda)ã€‚
è®¾ç½® JSON é…ç½®ï¼šæŒ‰ Ctrl+Shift+P æ‰“å¼€ Open Remote Settings (JSON)ï¼Œæ·»åŠ ï¼š
code
JSON
"r.rterm.linux": "/home/gao/micromamba/envs/spatial_R/bin/R",
"r.plot.useHttpgd": true,
"r.alwaysUseActiveTerminal": true
å¯åŠ¨ç»˜å›¾åŠ©æ‰‹ï¼šåœ¨ R ç»ˆç«¯è¾“å…¥ library(httpgd); hgd()ï¼Œè¿™æ ·ç”»å‡ºçš„ç©ºé—´å›¾ï¼ˆå¦‚ SpatialPlotï¼‰ä¼šç›´æ¥åœ¨ VS Code çª—å£å¼¹å‡ºã€‚
ğŸ’¡ é’ˆå¯¹ 9.7GB å†…å­˜çš„â€œç”Ÿå­˜æŒ‡å—â€ï¼ˆç©ºé—´ç‰ˆï¼‰
ç©ºé—´è½¬å½•ç»„æ•°æ®ï¼ˆå¦‚ Visium æˆ– Xeniumï¼‰æ¯”æ™®é€šå•ç»†èƒæ›´åƒå†…å­˜ï¼Œå› ä¸ºé™¤äº†è¡¨è¾¾çŸ©é˜µï¼Œè¿˜æœ‰é«˜åˆ†è¾¨ç‡å›¾åƒã€‚
æ˜¾å­˜ vs å†…å­˜ï¼šRTX 3060 æœ‰ 12GB æ˜¾å­˜ï¼Œè¿™æ¯”ä½ çš„ç³»ç»Ÿå†…å­˜è¿˜å¤§ï¼
æŠ€å·§ï¼šå°½é‡ä½¿ç”¨åŸºäºæ·±åº¦å­¦ä¹ çš„ç®—æ³•ï¼ˆå¦‚ scVI æˆ– DeepSTï¼‰ï¼Œå› ä¸ºå®ƒä»¬æŠŠæ•°æ®å¾€æ˜¾å­˜é‡Œæ‰”ï¼Œèƒ½å‡å°ç³»ç»Ÿå†…å­˜çš„å‹åŠ›ã€‚
å›¾åƒå¤„ç†ï¼š
åœ¨ Seurat ä¸­åŠ è½½ Visium æ•°æ®æ—¶ï¼Œå¦‚æœå†…å­˜æº¢å‡ºï¼Œè¯·è®¾ç½® filter.matrix = TRUEã€‚
ä½¿ç”¨ BPCells å¤„ç†æ•°æ®ã€‚Seurat v5 æ”¯æŒ BPCells å­˜å‚¨ï¼Œå®ƒå°†æ•°æ®å­˜åœ¨ç¡¬ç›˜ä¸Šè€Œä¸æ˜¯å†…å­˜é‡Œï¼Œè¿™å¯¹äº 10GB å†…å­˜çš„ç”µè„‘æ˜¯æ•‘å‘½ç¨»è‰ã€‚
GC å¼ºåˆ¶å›æ”¶ï¼š
åœ¨ R è„šæœ¬ä¸­é¢‘ç¹ä½¿ç”¨ gc() å‘½ä»¤æ‰‹åŠ¨é‡Šæ”¾å†…å­˜ã€‚
æ€»ç»“
åœ¨æ‚¨çš„è¿™å¥—é…ç½®ä¸‹ï¼Œæœ€ä½³å®è·µæ˜¯ï¼š
R (Seurat/Giotto)ï¼šç”¨äºåŸºç¡€è´¨æ§ã€èšç±»ã€å·®å¼‚åˆ†æã€ç©ºé—´çƒ­å›¾ç»˜åˆ¶ã€‚
Python (OmicVerse/Squidpy)ï¼šç”¨äºéœ€è¦ GPU åŠ é€Ÿçš„å¤æ‚è®¡ç®—ï¼Œå¦‚ç»†èƒç±»å‹è‡ªåŠ¨æ³¨é‡Šã€ç©ºé—´è½¨è¿¹æ¨æ–­ã€‚
æ¡¥æ¢ (Reticulate)ï¼šåœ¨ R é‡Œé¢ç›´æ¥è°ƒç”¨ Python çš„ GPU ç®—åŠ›ã€‚
æ‚¨ç°åœ¨çš„ spatial_R ç¯å¢ƒå·²ç»é…ç½®å®Œæˆï¼Œå¯ä»¥å¼€å§‹è¯»å–æ‚¨çš„ 10x Visium æˆ– Slide-seq æ•°æ®äº†ï¼